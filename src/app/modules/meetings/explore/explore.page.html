<ion-header>
  <ion-toolbar>
    <ion-title>{{ 'Explore' | translate }}</ion-title>
    <ion-buttons slot="end">
      <ion-button routerLink="/app/meetings/add">
        <ion-icon name="add" slot="icon-only"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <section class="d-flex flex-column minh-100 bg-ultra-light">
    <ng-container *ngIf="!isLoadingSuggestions && suggestions; else loading">
      <div
        *ngIf="
          suggestions.meetings.length > 0 ||
            suggestions.meetingRequests.length > 0;
          else empty
        "
        class="container py-3"
        [class.disabled]="isLoading"
      >
        <div
          class="meetings"
          *ngIf="suggestions.meetings.length > 0"
          [class.has-sibling]="suggestions.meetingRequests.length > 0"
        >
          <label
            [innerText]="'Near meetings to join' | translate"
            class="text-white"
          ></label>
          <div
            *ngFor="let meeting of suggestions.meetings"
            class="d-flex align-items-center bg-white mb-1 item"
          >
            <div class="py-2 pl-2" (click)="openMeetingDetails(meeting)">
              <div>
                <span class="font-weight-bold">{{ 'Date' | translate }}</span
                >: {{ meeting.date | date: 'dd.MM.yyyy' }}
              </div>
              <div>
                <span class="font-weight-bold">{{ 'City' | translate }}</span
                >: {{ meeting.city }}
              </div>
              <div>
                <span class="font-weight-bold">{{ 'People' | translate }}</span
                >: {{ meeting.users.length }}
              </div>
              <div>
                <span class="font-weight-bold">{{
                  'Activity' | translate
                }}</span
                >: {{ meeting.activity.name | translate }}
              </div>
            </div>
            <div
              class="join text-primary ml-auto align-self-stretch d-flex align-items-center px-3"
              [innerText]="'join' | translate"
              (click)="join(meeting.id)"
            ></div>
          </div>
        </div>
        <div class="requests" *ngIf="suggestions.meetingRequests.length > 0">
          <label
            [innerText]="'Near requests to connect' | translate"
            class="text-white"
          ></label>
          <div
            *ngFor="let request of suggestions.meetingRequests"
            class="d-flex align-items-center bg-white mb-1 item"
          >
            <div class="py-2 pl-2" (click)="openRequestDetails(request)">
              <div>
                <span class="font-weight-bold">{{ 'Date' | translate }}</span
                >: {{ getDate(request.minDate, request.maxDate) }}
              </div>
              <div>
                <span class="font-weight-bold">{{ 'City' | translate }}</span
                >: {{ request.city }}
              </div>
              <div>
                <span class="font-weight-bold">{{
                  'Activities' | translate
                }}</span
                >:
                <ng-container
                  *ngFor="let activity of request.activities; let i = index"
                >
                  <span class="d-inline-block">{{
                    activity.name | translate
                  }}</span>
                  <span *ngIf="i !== request.activities.length - 1">, </span>
                </ng-container>
              </div>
            </div>
            <div
              class="join text-primary ml-auto align-self-stretch d-flex align-items-center px-3"
              [innerText]="'connect' | translate"
              (click)="connect(request.id)"
            ></div>
          </div>
        </div>
        <div class="information">
          {{ 'Suggestions are based on your location.' | translate }}
        </div>
      </div>
      <ng-template #empty>
        <div class="empty m-auto text-center py-3">
          <div class="content container">
            <ion-icon name="contacts" class="big-icon text-primary"></ion-icon>
            <div class="header">
              {{ "Couldn't find any meetings around you." | translate }}
            </div>
            <p class="mt-3 mb-4">
              {{
                "It's time to specify your preferences or create your own meeting. You are one step away from changing your evening!"
                  | translate
              }}
            </p>
            <button
              routerLink="/app/meetings/add"
              class="btn btn-outline-primary px-4"
            >
              {{ 'Create now' | translate }}
            </button>
          </div>
        </div>
      </ng-template>
    </ng-container>
    <ng-template #loading>
      <div class="text-center py-3">
        <ion-spinner></ion-spinner>
      </div>
    </ng-template>
  </section>
</ion-content>
