<div class="content p-2 w-100" appAutoScroll #content>
  <div
    *ngIf="!isLoading && hasMoreMessages"
    (click)="loadMessages()"
    class="load text-center"
  >
    {{ 'Load more messages' | translate }}
  </div>
  <ng-container *ngFor="let message of messages; let i = index">
    <app-message
      *ngIf="findUser(message.userId) as meetingUser; else anonymous"
      [message]="message"
      [user]="meetingUser"
      [isMine]="user.id === message.userId"
      [isLast]="
        i === messages.length - 1
          ? true
          : messages[i].userId !== messages[i + 1].userId
      "
      [isFirst]="i === 0 ? true : messages[i].userId !== messages[i - 1].userId"
      [dateToShow]="dateToShow"
      (showDate)="showDate($event)"
    ></app-message>
    <ng-template #anonymous>
      <app-message-anonymous
        [message]="message"
        [isLast]="
          i === messages.length - 1
            ? true
            : messages[i].userId !== messages[i + 1].userId
        "
        [isFirst]="
          i === 0 ? true : messages[i].userId !== messages[i - 1].userId
        "
        [dateToShow]="dateToShow"
        (showDate)="showDate($event)"
      ></app-message-anonymous>
    </ng-template>
  </ng-container>
</div>
